<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>End-to-End Cloud Data Pipeline - Preston A. Carter</title>

    <!-- Load React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Load Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        html {
            scroll-behavior: smooth;
            scroll-padding-top: 2rem;
        }

        .jump-links {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
            padding: 1rem;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin: 2rem 0;
        }

            .jump-links a {
                color: #374151;
                text-decoration: none;
                padding: 0.5rem 1rem;
                border-radius: 5px;
                transition: all 0.3s ease;
                background: #f3f4f6;
                font-weight: 500;
            }

                .jump-links a:hover {
                    background: #e5e7eb;
                    transform: translateY(-1px);
                }

        .back-button {
            display: inline-block;
            padding: 10px 20px;
            background-color: #333;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin: 20px;
            transition: background-color 0.3s ease;
        }

            .back-button:hover {
                background-color: #555;
            }

        .tutorial-image {
            display: block;
            margin: 2rem auto;
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .project-section {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 1.5rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

            .project-section:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            }

            .project-section h3 {
                color: #333;
                font-size: 1.5rem;
                font-weight: 600;
                margin-bottom: 1rem;
                padding-bottom: 0.5rem;
                border-bottom: 2px solid #f0f0f0;
            }

            .project-section h4 {
                color: #374151;
                border-bottom: 1px solid #e5e7eb;
                padding-bottom: 0.5rem;
            }

            .project-section p {
                color: #4b5563;
                line-height: 1.6;
            }

            .project-section ul {
                list-style-type: disc;
                padding-left: 1.5rem;
            }

                .project-section ul li {
                    margin-bottom: 0.75rem;
                    position: relative;
                }

                    .project-section ul li::before {
                        content: "•";
                        position: absolute;
                        left: -1rem;
                        color: #666;
                    }

                .project-section ul ul {
                    margin-top: 0.5rem;
                    margin-left: 0.5rem;
                }

        .content-divider {
            height: 6px;
            background: linear-gradient(to right, #3b82f6, #8b5cf6);
            margin: 3rem 0;
            border-radius: 3px;
            opacity: 0.7;
        }

        @keyframes flow {
            0% {
                transform: translateX(-100%);
            }

            100% {
                transform: translateX(400%);
            }
        }

        .animate-flow {
            animation: flow 2s linear infinite;
        }

        @keyframes fade-in {
            0% {
                opacity: 0;
                transform: translateY(10px);
            }

            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fade-in 0.5s ease-out;
        }

        .detailed-content {
            background: #f8fafc;
            padding: 2rem 0;
            border-top: 1px solid #e2e8f0;
            margin-top: 3rem;
        }

        .project-overview {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin: 2rem 0;
        }

        .github-link {
            display: inline-flex;
            align-items: center;
            padding: 0.75rem 1.5rem;
            background-color: #24292e;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 500;
            transition: background-color 0.3s ease;
            margin-top: 1rem;
        }

            .github-link:hover {
                background-color: #2f363d;
            }

            .github-link svg {
                margin-right: 0.5rem;
            }

    </style>
</head>
<body class="bg-gray-50">
    <a href="../index.html" class="back-button">← Back to Portfolio</a>

    <!-- Header and Visualization Section -->
    <div class="max-w-4xl mx-auto px-4">
        <h1 class="text-4xl font-bold text-center mt-8 mb-4">End-to-End Cloud Data Pipeline</h1>
        <p class="text-center mb-12 text-gray-600">A comprehensive data pipeline processing Solar System data from raw API to analytics-ready datasets</p>

        <div id="pipeline-viz" class="mb-16"></div>

        <div class="content-divider"></div>

        <!-- New Project Overview Section -->
        <div class="project-overview">
            <h2 class="text-2xl font-semibold mb-4">Project Walkthrough</h2>
            <p class="text-gray-700 mb-4">
                The interactive visualization above represents the flow of this data pipeline project. Click on each stage to learn more about its specific role in the process. Below you'll find a comprehensive walkthrough of every component, including implementation details, configurations, and key decisions made during development. This walkthrough demonstrates how raw astronomical data is transformed into analytics-ready datasets through automated processes, quality controls, and careful orchestration.
            </p>
            <p class="text-gray-700 mb-6">
                Each section details a critical part of the pipeline, from initial API data collection through transformation and quality controls, to final analytics preparation. You'll see real examples of configurations, error handling, and monitoring approaches used in production.
            </p>
            <a href="https://github.com/preston-carter/solar_system_gcp_data_pipeline"
               target="_blank"
               class="github-link">
                <svg height="20" width="20" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z" />
                </svg>
                View Project on GitHub
            </a>
        </div>

        <!-- Add Jump Links Navigation -->
        <nav class="jump-links">
            <a href="#extraction">Data Extraction & Load</a>
            <a href="#transformation">Data Transformation</a>
            <a href="#quality">Data Quality & Monitoring</a>
            <a href="#analytics">Data Analytics</a>
            <a href="#future">Future Enhancements</a>
        </nav>
    </div>

    <!-- Detailed Content Section -->
    <div class="detailed-content">
        <div class="max-w-4xl mx-auto px-4">
            <div class="project-section" id="extraction">
                <h3>Data Extraction & Load</h3>
                <p class="mb-4">Every day using a GitHub actions workflow, raw planetary and moon data are extracted from a Solar System API and then loaded directly into BQ without transformation.</p>
                <img src="../images/daily_extract_load.png" alt="Daily Extract Load Process" class="tutorial-image"/>   
                
            </div>

            <div class="project-section" id="transformation">
                <h3>Data Transformation</h3>
                <p class="mb-4">These raw data are then transformed and refreshed daily using BQ and Dataform, which is a data transformation service that enables:</p>
                <ul class="mb-4">
                    <li>Development</li>
                    <li>Testing</li>
                    <li>Version control</li>
                    <li>Scheduling</li>
                    <li>Managing Dependencies</li>
                    <li>Manage table and field descriptions (Data Dictionary)</li>
                </ul>
                <p class="mb-4">Dataform, which syncs directly with a GitHub repository (repo), allows us to have separate development and production environments in BQ, which enables testing, code management, and production-level protection.</p>
                <img src="../images/prod_dev_datasets.png" alt="Production and Development Datasets" class="tutorial-image"/>

                <p class="mb-4">Dataform also allows us to schedule our transformation cycle to refresh daily. We can schedule this to run every day after our extract/load refresh in our GitHub repo. To do this:</p>
                <ul class="mb-4">
                    <li>We create a release configuration, which refreshes the compilation of our Dataform repo to reference most recently merged update in the production branch of our GitHub repo</li>
                    <li>We create a workflow configuration to schedule the Dataform repo to refresh all production tables, views, and assertions (discussed in the next section)</li>
                </ul>
                <img src="../images/release_workflow_configs.png" alt="Release and Workflow Configurations" class="tutorial-image"/>

            </div>

            <div class="project-section" id="quality">
                <h3>Data Quality & Monitoring</h3>

                <h4 class="text-xl font-semibold mt-6 mb-4">Data Quality</h4>
                <p class="mb-4">Dataform allows us to pass assertions directly within a table's script or manually, through a separate script for more complex data quality rules. This allows us to protect our transformation pipeline should any unexpected errors occur when validating the conditions for each table.</p>
                <p class="mb-4">For example, in our Moon and Planet tables, we have specified that each table a unique key and non-null field for both tables, MoonId and PlanetId, respectively.</p>
                <img src="../images/assertion_example.png" alt="Assertion Example" class="tutorial-image"/>

                <p class="mb-4">Should either of these validations fail, the metrics table that depends on these tables would not update, which protects the analytics data layer. Manually created assertions do not interrupt or impede the cycle, however. So if these validations fail, the pipeline will still run.</p>
                <p class="mb-4">For example, for our moon data, we do not have values for many of the physical data fields for moons. This is expected, and so because of this it is better to remove those assertions or just disable the manual assertions to prevent unnecessary failure notifications, which will be covered next.</p>
                <img src="../images/manual_assertions.png" alt="Manual Assertions" class="tutorial-image"/>

                <h4 class="text-xl font-semibold mt-6 mb-4">Data Monitoring</h4>
                <p class="mb-4">Dataform allows us to directly monitor anything we run in the repo. This could be:</p>
                <ul class="mb-4">
                    <li>A single table as we develop in the dev environment</li>
                    <li>A set of actions, say I want to run all actions tagged to 'SolarSystemBody' - the full dependency tree associated with this tag would run</li>
                    <li>All actions in our dev or prod environments (manually or scheduled)</li>
                </ul>
                <p class="mb-4">We can use the workflow execution logs to monitor all these runs and if there are any errors, we can investigate the cause:</p>
                <img src="../images/workflow_execution_logs.png" alt="Workflow Execution Logs" class="tutorial-image"/>

                <p class="mb-4">Example of a failed run:</p>
                <img src="../images/failed_run.png" alt="Failed Run" class="tutorial-image"/>
                <img src="../images/failed_run_details.png" alt="Failed Run Details" class="tutorial-image"/>

                <p class="mb-4">As mentioned before, given that we do not need to monitor the manual assertions to check data quality for our Moon dataset, let's disable this script so it will not error our future runs (even though the run still completed successfully, just the manual assertion failed - this will add noise to our runs if we leave enabled. In a normal situation, these assertions would be monitored and the data corrected as opposed to just turning off the data quality checks).</p>
                <img src="../images/moon_manual_assertions_config.png" alt="Moon Manual Assertions Config" class="tutorial-image"/>

                <p class="mb-4">And after disabling, we see that our next full production cycle, does not have any errors:</p>
                <img src="../images/run_success.png" alt="Successful Run" class="tutorial-image"/>                
            </div>

            <div class="project-section" id="analytics">
                <h3>Data Analytics</h3>
                <p class="mb-4">The final table in our pipeline is PlanetaryMoonMetrics which is a dataset created specifically to enable analytics by calculating specific metric values and adding dimensions, both of which would empower data visualizations and reports.</p>

                <h4 class="text-xl font-semibold mt-6 mb-4">Data Dictionary</h4>
                <p class="mb-4">It was mentioned in the first section that Dataform also allows for management of table and field descriptions, which will be reflected in the tables themselves in BQ. This is done by entering these descriptions in the table's configuration:</p>
                <img src="../images/table_config.png" alt="Table Configuration" class="tutorial-image"/>
            </div>

            <div class="project-section" id="future">
                <h3>Potential Future Enhancements or Considerations</h3>
                <p class="mb-4">This example was set up to be very simple and streamlined, but this demo could be enhanced in the following ways in the future:</p>
                <ul class="mb-4">
                    <li>Add a visualization using Looker (viz tool in GCP) or another application</li>
                    <li>Create a more complex data refresh schedule</li>
                    <li>
                        After the GitHub actions workflow completes, use this to start the Dataform cycle, this would require either another workflow or using tools such as:
                        <ul class="ml-6">
                            <li>Google Cloud Function with Cloud Log Monitoring and Pub/Sub</li>
                            <li>Cloud Composer and Airflow</li>
                        </ul>
                    </li>
                    <li>
                        Redeveloping this entire pipeline process using other cloud environments or tools like:
                        <ul class="ml-6">
                            <li>AWS</li>
                            <li>Azure</li>
                            <li>dbt</li>
                            <li>Snowflake</li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <!-- React Pipeline Component Script -->
    <script>
        // (Previous React component code remains exactly the same)
        const PipelineStage = ({ title, icon, color, isActive, onClick }) => {
            return React.createElement('div', {
                onClick: onClick,
                className: `
                                w-28 h-28
                                rounded-full
                                flex flex-col items-center justify-center
                                cursor-pointer
                                transition-all duration-500
                                ${color}
                                ${isActive ? 'scale-110 shadow-xl ring-4 ring-blue-300' : 'hover:scale-105 hover:shadow-lg'}
                                relative
                                z-10
                            `
            }, [
                React.createElement('div', { className: 'text-2xl mb-2', key: 'icon' }, icon),
                React.createElement('div', { className: 'text-sm font-semibold text-center', key: 'title' }, title),
                isActive && React.createElement('div', {
                    className: 'absolute inset-0 rounded-full animate-ping opacity-25 bg-blue-400',
                    key: 'ping'
                })
            ]);
        };

        const Pipeline = () => {
            const [activeStage, setActiveStage] = React.useState(null);

            const stages = [
                {
                    title: 'Extract',
                    fullTitle: 'Data Extraction',
                    icon: '🌍',
                    color: 'bg-blue-100',
                    description: 'Python script extracts celestial body data from Solar System OpenData API with daily automated updates via GitHub Actions.'
                },
                {
                    title: 'Load',
                    fullTitle: 'Raw Data Layer',
                    icon: '💾',
                    color: 'bg-green-100',
                    description: 'Raw JSON data loaded into BigQuery staging tables, preserving original structure with auto-detected schema.'
                },
                {
                    title: 'Transform',
                    fullTitle: 'Transformation Layer',
                    icon: '⚙️',
                    color: 'bg-yellow-100',
                    description: 'Dataform creates standardized Planet and Moon tables with proper relationships and field mappings.'
                },
                {
                    title: 'Quality',
                    fullTitle: 'Data Quality',
                    icon: '✔️',
                    color: 'bg-purple-100',
                    description: 'Automated assertions validate physical properties, relationships, and data integrity across all tables.'
                },
                {
                    title: 'Analytics',
                    fullTitle: 'Analytics Layer',
                    icon: '📊',
                    color: 'bg-indigo-100',
                    description: 'Statistical analysis and aggregated metrics of planetary systems prepared for visualization and reporting.'
                }
            ];

            return React.createElement('div', {
                className: 'p-8 bg-white rounded-xl shadow-lg mb-8'
            }, [
                React.createElement('div', {
                    className: 'flex items-center justify-between mb-8 relative',
                    key: 'stages'
                }, stages.map((stage, index) => React.createElement(React.Fragment, { key: stage.title }, [
                    React.createElement(PipelineStage, {
                        key: `stage-${index}`,
                        title: stage.title,
                        icon: stage.icon,
                        color: stage.color,
                        isActive: activeStage === index,
                        onClick: () => setActiveStage(activeStage === index ? null : index)
                    }),
                    index < stages.length - 1 && React.createElement('div', {
                        className: 'flex-grow mx-0 relative',
                        style: { margin: '0 -10px' },
                        key: `connector-${index}`
                    }, React.createElement('div', {
                        className: 'h-3 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 rounded-full relative overflow-hidden'
                    }, React.createElement('div', {
                        className: 'absolute inset-0'
                    }, React.createElement('div', {
                        className: 'absolute top-0 left-0 w-full h-full flex items-center'
                    }, React.createElement('div', {
                        className: 'w-4 h-4 rounded-full bg-blue-400 shadow-lg shadow-blue-400/50 animate-flow'
                    })))))
                ]))),
                activeStage !== null && React.createElement('div', {
                    className: 'bg-gray-50 p-6 rounded-lg shadow-md transition-all duration-500 animate-fade-in',
                    key: 'description'
                }, [
                    React.createElement('h3', {
                        className: 'text-xl font-bold mb-3 text-gray-800',
                        key: 'title'
                    }, stages[activeStage].fullTitle),
                    React.createElement('p', {
                        className: 'text-gray-600 mb-4',
                        key: 'desc'
                    }, stages[activeStage].description)
                ])
            ]);
        };

        // Wait for DOM to load
        document.addEventListener('DOMContentLoaded', () => {
            const root = ReactDOM.createRoot(document.getElementById('pipeline-viz'));
            root.render(React.createElement(Pipeline));
        });
    </script>
</body>
</html>